-- Verification queries for {{ relationship.type }} relationships
SELECT count(*) FROM cypher('{{ project_name }}', $$
    MATCH ()-[r:{{ relationship.type }}]->()
    WHERE r.source_dataset = '{{ table_name }}'
    RETURN count(r)
$$) as (count agtype);

-- Sample relationships with properties
SELECT * FROM cypher('{{ project_name }}', $$
    MATCH (s)-[r:{{ relationship.type }}]->(t)
    WHERE r.source_dataset = '{{ table_name }}'
    RETURN s.name as source, 
           type(r) as relationship, 
           t.name as target,
           {% if relationship.properties %}
           {% for prop_key in relationship.properties.keys() %}
           r.{{ prop_key }} as {{ prop_key }},
           {% endfor %}
           {% endif %}
           r.year as year,
           r.value as value,
           r.unit as unit
    LIMIT 10
$$) as (source agtype, relationship agtype, target agtype
{% if relationship.properties %}
{% for prop_key in relationship.properties.keys() %}, {{ prop_key }} agtype{% endfor %}
{% endif %}
, year agtype, value agtype, unit agtype);